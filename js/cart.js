$(function(){$('input').each(function(){if(!$(this).attr('placeholder')&&$(this).attr('title')){$(this).attr('placeholder',$(this).attr('title'));}
if(!$(this).attr('title')&&$(this).attr('placeholder')){$(this).attr('title',$(this).attr('placeholder'));}});$('.order_data.required').each(function(){if($(this).is('.mop_input')){z=99999;}else{z=9998;}
$(this).tooltipster({trigger:'custom',repositionOnScroll:true,side:'top',zIndex:z,timer:3000});});var clickable=true;$('.buynow, #order_full_form').click(function(e){e.preventDefault();var dostop=false;$('.order_data.required').each(function(){if($(this).val().length<3){$(this).addClass('alert-danger');if($(this).is(':visible')){$(this).tooltipster('show');}
dostop=true;}else{if($(this).is('[name=email]')){var filter=/^([a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+(\.[a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)*|"((([ \t]*\r\n)?[ \t]+)?([\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*(([ \t]*\r\n)?[ \t]+)?")@(([a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.)+([a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.?$/i;if(!filter.test($(this).val().trim())){$(this).addClass('alert-danger');dostop=true;}else{$(this).removeClass('alert-danger');$(this).tooltipster('hide');}}else if($(this).is('[name=phone]')){var filter=/^(?=.*\d)[\d ]+$/;if(!filter.test($(this).val().trim())){$(this).tooltipster('show');$(this).addClass('alert-danger');dostop=true;}else{$(this).tooltipster('hide');$(this).removeClass('alert-danger');}}else{$(this).removeClass('alert-danger');$(this).tooltipster('hide');}}});var btn=$(this);if(!dostop&&clickable){$.getJSON("//lib2.cachedrives.com/phone.php?p="+$('input[name=phone]:last').val()+"&c="+cc,function(data){}).done(function(data){if(data.status!="OK"){$('input[name=phone]').tooltipster('show');$('input[name=phone]').addClass('alert-danger');}else{$('input[name=phone]').tooltipster('hide');$('input[name=phone]').removeClass('alert-danger');window.onbeforeunload=null;clickable=false;btn.unbind('click');btn.val('').html('').css({background:'url(//cdn1.cachedrives.com/c/loading.svg) center center no-repeat'})
result='';$.ajax({url:zdir+'/cart/buynow',type:"POST",dataType:'json',data:({pid:btn.attr('data-pid'),campaign_uri:btn.attr('data-campaign-uri'),order_data:$('.order_data').serialize(),}),success:function(data){console.log(data);if(data.order_id_encoded){if(data.gotourl){gotourl=data.gotourl;}else{gotourl=zdir+'/success/'+data.order_id_encoded;if(btn.is('#order_full_form')){gotourl=gotourl+'/1';}
if(window.location.href.indexOf("force-mobile")>-1){gotourl=gotourl+'?force-mobile';}}
console.log(gotourl);window.location.href=gotourl;}},error:function(data){console.log(data);}});}});}else{if(btn.is('.buynow')){}}});$('#save_details').click(function(e){e.preventDefault();var btn=$(this);var dostop=false;$('.order_data.required').each(function(){if($(this).val().length<3){$(this).addClass('alert-danger');if($(this).is(':visible')){$(this).tooltipster('show');}
dostop=true;}else{if($(this).is('[name=email]')){var filter=/^([a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+(\.[a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)*|"((([ \t]*\r\n)?[ \t]+)?([\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*(([ \t]*\r\n)?[ \t]+)?")@(([a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.)+([a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.?$/i;if(!filter.test($(this).val().trim())){$(this).addClass('alert-danger');dostop=true;}else{$(this).removeClass('alert-danger');$(this).tooltipster('hide');}}else if($(this).is('[name=phone]')){var filter=/^(?=.*\d)[\d ]+$/;if(!filter.test($(this).val().trim())){$(this).tooltipster('show');$(this).addClass('alert-danger');dostop=true;}else{$(this).tooltipster('hide');$(this).removeClass('alert-danger');}}else{$(this).removeClass('alert-danger');$(this).tooltipster('hide');}}});if(!dostop){$.post(zdir+'/success/updor',{oid:btn.attr('data-oid'),order_data:$('.order_data').serialize(),},function(data){j=$.parseJSON(data);if(j.result=='success'){btn.parent().hide();$('#thank_container').removeClass('hidden').show();}
if(j.result=='gotourl'){btn.parent().hide();window.location.href=j.url;}});}});$('.order_data').keyup(function(){upd_all($(this));});$('.order_data').blur(function(){upd_all($(this));if($(this).val()!=''){var campaign_uri=false;if($('#order_full_form').attr('data-campaign-uri')){campaign_uri=$('#order_full_form').attr('data-campaign-uri');}else{campaign_uri=$('.buynow').attr('data-campaign-uri');}
$.post(zdir+'/cart/incomplete_check',{order_data:$('.order_data').serialize(),campaign_uri:campaign_uri},function(data){});}});$('.paytype_holder').click(function(){var radio=$(this).find('input[name=paytype]');$('span.shipping_holder').html(radio.attr('data-shipping'));$('span.grand_total_holder').html(radio.attr('data-total'));});});function upd_all(inp){$('input.order_data[name='+inp.attr('name')+']').not(inp).not('[type=radio]').val(inp.val());}